{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "13288429_68736369",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2025-07-09T22:03:23Z",
      "side": 1,
      "message": "I believe this is the wrong level of the fix. Yes, normalisation is needed, but all across the board, not just in that piece of code.\n\nSee my comments and suggestions on where the normalisation should be added.",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9f8a5337_4c2f0aa6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2025-07-09T22:38:59Z",
      "side": 1,
      "message": "@danielesassoli@gmail.com see an alternative sanitisation with I272f0637a",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d1644b58_ea3bb776",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1155599
      },
      "writtenOn": "2025-07-10T08:38:44Z",
      "side": 1,
      "message": "See reply in above comment.",
      "parentUuid": "9f8a5337_4c2f0aa6",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4dbbef67_71313862",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1155599
      },
      "writtenOn": "2025-07-10T08:38:44Z",
      "side": 1,
      "message": "So, the fix you propose at I272f0637a to me seems pretty much the same thing but done in 4 different places rather than 1. All the methods there end up calling this method here, so not sure why we\u0027d move the normalisation one level above.\n\nAnother option could be to normalise newValue in refPair constructor, WDYT?",
      "parentUuid": "13288429_68736369",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "845c274b_03453f0b",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2025-07-08T20:36:29Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4983492a_e328d5a1",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2025-07-08T20:39:15Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8a8c8dd6_4f1d0489",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2025-07-08T20:44:08Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6ca5001b_b0da163a",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2025-07-08T20:47:04Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ea3b182c_f266cd80",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2025-07-08T20:50:06Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8d1a9360_3645c81f",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2025-07-08T20:53:04Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e594d0e0_bcdbbf8d",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2025-07-08T20:53:04Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d62d2332_f5cb833c",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2025-07-08T20:57:01Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6ad01e79_80dca4a7",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2025-07-08T21:04:13Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d09514c5_6fde6d2d",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2025-07-08T21:07:14Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fc37e28f_0850c519",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2025-07-08T22:14:40Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "be170a76_fea536cc",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2025-07-08T22:17:18Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "98a34a61_cc3d4b00",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2025-07-08T22:17:18Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "66485f43_9b61fa3f",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2025-07-08T22:20:11Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c7849d06_920d8e1a",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2025-07-08T22:20:11Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c3865cc0_9733c058",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2025-07-08T22:23:20Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a10b19f0_5796a77f",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2025-07-08T22:28:50Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c63eb102_e625babe",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1022687
      },
      "writtenOn": "2025-07-08T23:05:10Z",
      "side": 1,
      "message": "Needs reformatting with GJF",
      "tag": "autogenerated:jenkins",
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "61d81dcf_103ebcd8",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 230,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2025-07-09T04:46:19Z",
      "side": 1,
      "message": "I am puzzled about how `refPair.putValue` could be null, though.\nThe `localObjectId` is clear: the ref isn\u0027t present in the local refdb. However, for `refPair.putValue` is what we are about to store; for deleted refs, it should be a set of zeros.\n\nDo we have the same issue in master? How can we reproduce it? What is the issue id?",
      "range": {
        "startLine": 230,
        "startChar": 12,
        "endLine": 230,
        "endChar": 49
      },
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "56845342_35fd8f19",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 230,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2025-07-09T22:03:23Z",
      "side": 1,
      "message": "By analysing the code in Gerrit, the `putValue` should have been set to zeros. However, in some code paths, the _normalisation_ is missing and therefore the `null` value is propagated downstream.\n\nI believe we should operate in two ways:\n\n1. Copy the defensive replacement of `null` to `ObjectId.zeros()` into the `SharedRefDbRefUpdate` and `SharedRefDbBatchRefUpdate`, so that regardless of Gerrit missing normalisations, the global-refdb would still behave correctly.\n\n2. Add the correct normalisation also in the code that deletes change edits in Gerrit (maybe from master onwards).",
      "parentUuid": "61d81dcf_103ebcd8",
      "range": {
        "startLine": 230,
        "startChar": 12,
        "endLine": 230,
        "endChar": 49
      },
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a8279dc1_fcad2bf7",
        "filename": "src/main/java/com/gerritforge/gerrit/globalrefdb/validation/RefUpdateValidator.java",
        "patchSetId": 7
      },
      "lineNbr": 230,
      "author": {
        "id": 1155599
      },
      "writtenOn": "2025-07-10T08:38:44Z",
      "side": 1,
      "message": "Points 2 has already been done with I0602aa0, point 1 we\u0027re discussing above.",
      "parentUuid": "56845342_35fd8f19",
      "range": {
        "startLine": 230,
        "startChar": 12,
        "endLine": 230,
        "endChar": 49
      },
      "revId": "e27ba918e3a7ffdab1da3018e69bace069ad3c76",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}